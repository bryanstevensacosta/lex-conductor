spec_version: v1
name: memory_agent
version: 1.0.0
description: Manages jurisprudential recall and retrieves historical legal precedents
type: external

connection:
  type: agent_connect
  endpoint: https://lexconductor-agents.25rf0qd39xzz.jp-osa.codeengine.appdomain.cloud/memory/v1/chat
  timeout: 30
  retry:
    max_attempts: 3
    backoff: exponential

capabilities:
  - precedent_search
  - historical_analysis
  - golden_clause_retrieval
  - pattern_recognition
  - institutional_memory

system_prompt: |
  You are the Memory Agent, a specialized legal AI that manages institutional memory and precedents.
  
  Your expertise:
  - Searching historical contract decisions
  - Finding similar past cases
  - Retrieving Golden Clauses from company policy library
  - Identifying patterns in legal modifications
  - Providing precedent-based recommendations
  
  Data Sources:
  1. Golden Clauses: Company-approved standard contract clauses
  2. Historical Decisions: Past contract reviews and modifications
  3. Precedent Patterns: Common modification patterns by contract type
  
  Your analysis process:
  1. Query Cloudant for similar contracts
  2. Filter by contract type, jurisdiction, and date range
  3. Retrieve relevant Golden Clauses
  4. Find historical precedents
  5. Identify modification patterns
  6. Calculate confidence based on precedent strength
  7. Provide structured recommendations
  
  Search Strategies:
  - By contract type (exact match)
  - By jurisdiction (exact or similar)
  - By clause type (indemnification, liability, etc.)
  - By confidence score (>0.85 preferred)
  - By recency (last 12 months preferred)
  
  Output format: Structured JSON with precedents and recommendations

input_schema:
  type: object
  properties:
    contract_type:
      type: string
      description: Type of contract to search for
    jurisdiction:
      type: string
      description: Applicable jurisdiction
    clause_focus:
      type: string
      description: Specific clause type to focus on (optional)
    date_range:
      type: object
      description: Date range for historical search (optional)
      properties:
        start:
          type: string
          format: date
        end:
          type: string
          format: date
    min_confidence:
      type: number
      description: Minimum confidence score for precedents (default 0.80)
      minimum: 0.0
      maximum: 1.0
    max_results:
      type: integer
      description: Maximum number of precedents to return (default 10)
      minimum: 1
      maximum: 50
  required:
    - contract_type

output_schema:
  type: object
  properties:
    golden_clauses:
      type: array
      items:
        type: object
        properties:
          clause_id:
            type: string
          type:
            type: string
          text:
            type: string
          contract_types:
            type: array
            items:
              type: string
          jurisdiction:
            type: string
          mandatory:
            type: boolean
          risk_level:
            type: string
            enum: [LOW, MEDIUM, HIGH]
          last_reviewed:
            type: string
            format: date
          confidence:
            type: number
    historical_precedents:
      type: array
      items:
        type: object
        properties:
          decision_id:
            type: string
          contract_type:
            type: string
          date:
            type: string
            format: date
          modifications:
            type: array
            items:
              type: object
              properties:
                clause:
                  type: string
                original_text:
                  type: string
                modified_text:
                  type: string
                rationale:
                  type: string
          approved_by:
            type: string
          confidence:
            type: number
          relevance_score:
            type: number
    modification_patterns:
      type: array
      items:
        type: object
        properties:
          pattern:
            type: string
          frequency:
            type: integer
          success_rate:
            type: number
          typical_rationale:
            type: string
    recommendations:
      type: array
      items:
        type: object
        properties:
          action:
            type: string
          based_on:
            type: string
          precedent_count:
            type: integer
          confidence:
            type: number
    summary:
      type: object
      properties:
        total_precedents_found:
          type: integer
        average_confidence:
          type: number
        most_common_modification:
          type: string
        recommendation_strength:
          type: string
          enum: [WEAK, MODERATE, STRONG, VERY_STRONG]
  required:
    - golden_clauses
    - historical_precedents
    - recommendations
    - summary

query_examples:
  - description: Find NDA precedents in US jurisdiction
    input:
      contract_type: NDA
      jurisdiction: US
      min_confidence: 0.85
      max_results: 10
  
  - description: Find liability clause modifications
    input:
      contract_type: MSA
      clause_focus: Liability
      date_range:
        start: "2025-01-01"
        end: "2026-01-30"
  
  - description: Find high-confidence Golden Clauses
    input:
      contract_type: Service Agreement
      jurisdiction: EU
      min_confidence: 0.90

error_handling:
  on_timeout:
    action: retry
    message: "Memory search timed out. Retrying..."
  on_error:
    action: return_empty
    message: "Memory search encountered an error. Returning empty results."
  on_no_results:
    action: return_default_clauses
    message: "No precedents found. Returning default Golden Clauses."

performance:
  expected_response_time: 2000  # milliseconds
  max_response_time: 3000
  cache_ttl: 1800  # Cache results for 30 minutes

caching_strategy:
  cache_golden_clauses: true
  cache_recent_precedents: true
  cache_modification_patterns: true
  invalidate_on_new_decision: true

metadata:
  author: Team AI Kings
  created: 2026-01-30
  hackathon: IBM Dev Day AI Demystified 2026
  data_sources:
    - Cloudant (golden_clauses database)
    - Cloudant (historical_decisions database)
  tags:
    - memory
    - precedents
    - golden-clauses
    - institutional-knowledge
    - external-agent
