spec_version: v1
name: routing_agent
version: 1.0.0
description: Dynamically classifies contract complexity and routes to appropriate workflow
type: external

connection:
  type: agent_connect
  endpoint: https://lexconductor-agents.25rf0qd39xzz.jp-osa.codeengine.appdomain.cloud/routing/v1/chat
  timeout: 30
  retry:
    max_attempts: 3
    backoff: exponential

capabilities:
  - risk_assessment
  - complexity_classification
  - workflow_routing
  - human_in_loop_determination

system_prompt: |
  You are the Routing Agent, a specialized legal AI that assesses risk and determines workflow routing.
  
  Your expertise:
  - Analyzing contract complexity and risk level
  - Classifying contracts into routing categories
  - Determining appropriate human-in-the-loop requirements
  - Providing justification for routing decisions
  
  Routing Categories:
  1. ROUTINE (Low Risk):
     - Standard contracts with no compliance gaps
     - Confidence > 0.90
     - Auto-approve with Golden Clauses
     - No human review required
     - Examples: Standard NDAs, simple agreements
  
  2. STANDARD (Medium Risk):
     - Moderate complexity with some gaps
     - Confidence 0.70 - 0.90
     - Paralegal review required
     - Human validates recommendations
     - Examples: Vendor contracts, service agreements
  
  3. COMPLEX (High Risk):
     - High-stakes or complex matters
     - Confidence < 0.70 or critical gaps
     - General Counsel escalation required
     - Full human review and decision
     - Examples: M&A, litigation, major partnerships
  
  Risk Factors to Consider:
  - Number and severity of compliance gaps
  - Confidence scores from Fusion Agent
  - Contract value and strategic importance
  - Regulatory complexity
  - Historical precedent availability
  - Jurisdiction complexity
  
  Your analysis process:
  1. Analyze Fusion Agent output
  2. Calculate risk score (0.0 to 1.0)
  3. Classify complexity level
  4. Determine routing category
  5. Specify human-in-loop requirements
  6. Provide clear justification
  
  Output format: Structured JSON with routing decision and rationale

input_schema:
  type: object
  properties:
    fusion_output:
      type: object
      description: Complete output from Fusion Agent
      properties:
        gaps:
          type: array
        confidence:
          type: number
        internal_signals:
          type: array
        external_signals:
          type: array
    contract_type:
      type: string
      description: Type of contract
    contract_value:
      type: number
      description: Estimated contract value in USD (optional)
    strategic_importance:
      type: string
      description: Strategic importance level (optional)
      enum:
        - LOW
        - MEDIUM
        - HIGH
        - CRITICAL
  required:
    - fusion_output
    - contract_type

output_schema:
  type: object
  properties:
    risk_score:
      type: number
      minimum: 0.0
      maximum: 1.0
      description: Overall risk score (0=low, 1=high)
    complexity_level:
      type: string
      enum:
        - LOW
        - MEDIUM
        - HIGH
      description: Contract complexity classification
    routing_decision:
      type: string
      enum:
        - ROUTINE
        - STANDARD
        - COMPLEX
      description: Workflow routing category
    human_in_loop:
      type: object
      properties:
        required:
          type: boolean
        role:
          type: string
          enum:
            - NONE
            - PARALEGAL
            - LEGAL_COUNSEL
            - GENERAL_COUNSEL
        action:
          type: string
          enum:
            - AUTO_APPROVE
            - REVIEW_AND_APPROVE
            - FULL_REVIEW
            - ESCALATE
    risk_factors:
      type: array
      items:
        type: object
        properties:
          factor:
            type: string
          severity:
            type: string
            enum: [LOW, MEDIUM, HIGH, CRITICAL]
          impact:
            type: string
    justification:
      type: string
      description: Clear explanation of routing decision
    estimated_review_time:
      type: string
      description: Expected time for human review (if applicable)
      examples:
        - "30 seconds"
        - "5 minutes"
        - "2 hours"
    confidence:
      type: number
      minimum: 0.0
      maximum: 1.0
      description: Confidence in routing decision
  required:
    - risk_score
    - complexity_level
    - routing_decision
    - human_in_loop
    - justification
    - confidence

decision_rules:
  routine:
    conditions:
      - risk_score < 0.3
      - confidence > 0.90
      - gaps_count = 0 OR gaps_severity = LOW
    action: AUTO_APPROVE
    human_role: NONE
  
  standard:
    conditions:
      - risk_score >= 0.3 AND risk_score < 0.7
      - confidence >= 0.70 AND confidence <= 0.90
      - gaps_count <= 5 AND gaps_severity <= MEDIUM
    action: REVIEW_AND_APPROVE
    human_role: PARALEGAL
  
  complex:
    conditions:
      - risk_score >= 0.7
      - confidence < 0.70
      - gaps_severity = HIGH OR CRITICAL
      - contract_type IN [M&A, Litigation, Major Partnership]
    action: ESCALATE
    human_role: GENERAL_COUNSEL

error_handling:
  on_timeout:
    action: retry
    message: "Routing analysis timed out. Retrying..."
  on_error:
    action: default_to_complex
    message: "Routing analysis error. Defaulting to COMPLEX for safety."

performance:
  expected_response_time: 1000  # milliseconds
  max_response_time: 2000

metadata:
  author: Team AI Kings
  created: 2026-01-30
  hackathon: IBM Dev Day AI Demystified 2026
  tags:
    - routing
    - risk-assessment
    - workflow
    - external-agent
